{"version":3,"sources":["client.ts","util.ts","components/Button.tsx","components/Dialog.tsx","components/Error.tsx","components/Loading.tsx","components/RatesTable.tsx","components/Rates.tsx","components/App.tsx","components/ClientApp.tsx","index.tsx"],"names":["cache","InMemoryCache","stateLink","withClientState","defaults","active","resolvers","restLink","RestLink","typePatcher","RatePayload","data","rates","Object","entries","map","_ref","_ref2","slicedToArray","__typename","code","rate","uri","link","ApolloLink","from","client","ApolloClient","fetch","window","Delay","duration","Promise","resolve","setTimeout","failFetch","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","Error","stop","this","apply","arguments","simulateFail","checked","target","Button","text","onClick","react_default","createElement","Dialog","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","close","setState","open","onDismiss","state","className","children","components_Button","dismissLabel","React","Component","defaultProps","message","components_Dialog","role","style","marginTop","Loading","_ref$interval","interval","aria-busy","aria-label","$nest","& span:before","content","& span","fontSize","animationDuration","concat","animationName","keyframes","opacity","to","animationIterationCount","animationDirection","& span:nth-of-type(2)","animationDelay","& span:nth-of-type(3)","RatesTable","_ref$payload$data","payload","base","date","whiteSpace","key","GET_LATEST","gql","_templateObject","Rates","react_apollo_browser_umd","query","fetchPolicy","notifyOnNetworkStatusChange","loading","error","refetch","networkStatus","NetworkStatus","components_Loading","components_Error","components_RatesTable","GET_ACTIVE","App_templateObject","App","type","onChange","defaultChecked","components_Rates","writeData","ClientApp","components_App","ReactDOM","render","components_ClientApp","document","querySelector"],"mappings":"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","file":"static/js/main.b68f17c6.chunk.js","sourcesContent":["import { InMemoryCache } from \"apollo-cache-inmemory\";\nimport { ApolloClient } from \"apollo-client\";\nimport { ApolloLink } from \"apollo-link\";\nimport { RestLink } from \"apollo-link-rest\";\nimport { withClientState } from \"apollo-link-state\";\n\nconst cache = new InMemoryCache();\nconst stateLink = withClientState({\n  cache,\n  defaults: {\n    active: false,\n  },\n  resolvers: {},\n});\nconst restLink = new RestLink({\n  typePatcher: {\n    RatePayload: (data: any): any => {\n      if (data.rates != null) {\n        data.rates = Object.entries(data.rates).map(([code, rate]) => ({\n          __typename: \"Rate\",\n          code,\n          rate,\n        }));\n      }\n      return data;\n    },\n  },\n  uri: \"https://api.exchangeratesapi.io/\",\n});\nconst link = ApolloLink.from([stateLink, restLink]);\nconst client = new ApolloClient({ cache, link });\n\nexport default client;\n","const { fetch } = window;\n\nexport const Delay = (duration: number) =>\n  new Promise(resolve => setTimeout(resolve, duration));\n\nconst failFetch = async () => {\n  await Delay(500);\n  throw Error(\"Simulated network failure\");\n};\n\nexport const simulateFail = ({\n  target: { checked },\n}: React.ChangeEvent<HTMLInputElement>) => {\n  window.fetch = checked ? failFetch : fetch;\n};\n","import React from \"react\";\n\nconst Button = ({ text, onClick }: { text: string; onClick: () => void }) => (\n  <button onClick={onClick}>{text}</button>\n);\n\nexport default Button;\n","import React from \"react\";\nimport Button from \"./Button\";\n\ninterface Props {\n  onDismiss: () => void;\n  dismissLabel: string;\n}\n\nclass Dialog extends React.Component<Props, { open: boolean }> {\n  static defaultProps = {\n    dismissLabel: \"Close\",\n  };\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      open: true,\n    };\n  }\n\n  render() {\n    return (\n      <dialog open={this.state.open}>\n        <div className=\"content\">{this.props.children}</div>\n        <footer>\n          <Button onClick={this.close} text={this.props.dismissLabel} />\n        </footer>\n      </dialog>\n    );\n  }\n\n  private close = (): void => {\n    this.setState({ open: false });\n    this.props.onDismiss();\n  };\n}\n\nexport default Dialog;\n","import React from \"react\";\nimport { style } from \"typestyle\";\nimport Dialog from \"./Dialog\";\n\ninterface Props {\n  message: string;\n  onDismiss: () => void;\n  dismissLabel: string;\n}\n\nconst Error = ({ message, onDismiss, dismissLabel }: Props) => (\n  <Dialog {...{ onDismiss, dismissLabel }}>\n    <p role=\"heading\" className={style({\n      marginTop: 0,\n    })}>Error</p>\n    <p>{message}</p>\n  </Dialog>\n);\n\nexport default Error;\n","import React from \"react\";\nimport { keyframes, style } from \"typestyle\";\n\nconst Loading = ({ interval = 0.35 }) => (\n  <div\n    role=\"alert\"\n    aria-busy=\"true\"\n    aria-label=\"Loading\"\n    className={style({\n      $nest: {\n        \"& span:before\": {\n          content: `\"â€¢\"`,\n        },\n        \"& span\": {\n          fontSize: \"3rem\",\n          animationDuration: `${interval}s`,\n          animationName: keyframes({\n            from: { opacity: 0 },\n            to: { opacity: 1 },\n          }),\n          animationIterationCount: \"infinite\",\n          animationDirection: \"alternate\",\n        },\n        \"& span:nth-of-type(2)\": {\n          animationDelay: `${interval / 2}s`,\n        },\n        \"& span:nth-of-type(3)\": {\n          animationDelay: `${interval}s`,\n        },\n      },\n    })}\n  >\n    <span />\n    <span />\n    <span />\n  </div>\n);\n\nexport default Loading;\n","import React from \"react\";\nimport { style } from \"typestyle\";\nimport { Rate, RatePayload } from \"../types\";\n\nconst RatesTable = ({\n  payload: {\n    data: { rates, base, date },\n  },\n}: {\n  payload: RatePayload;\n}) => (\n  <table>\n    <caption\n      className={style({\n        whiteSpace: `nowrap`,\n      })}\n    >\n      <span>{base}</span> <span>{date}</span>\n    </caption>\n    <thead>\n      <tr>\n        <th>Code</th>\n        <th>Rate</th>\n      </tr>\n    </thead>\n    <tbody>\n      {rates.map(({ code, rate }: Rate) => (\n        <tr key={code}>\n          <td>{code}</td>\n          <td>{rate}</td>\n        </tr>\n      ))}\n    </tbody>\n  </table>\n);\n\nexport default RatesTable;\n","import { NetworkStatus } from \"apollo-client\";\nimport gql from \"graphql-tag\";\nimport React from \"react\";\nimport { Query } from \"react-apollo\";\nimport Button from \"./Button\";\nimport Error from \"./Error\";\nimport Loading from \"./Loading\";\nimport RatesTable from \"./RatesTable\";\n\nconst GET_LATEST = gql`\n  {\n    data @rest(type: \"RatePayload\", path: \"latest\") {\n      date\n      base\n      rates\n    }\n  }\n`;\n\nconst Rates = () => (\n  <Query\n    query={GET_LATEST}\n    fetchPolicy=\"cache-and-network\"\n    notifyOnNetworkStatusChange\n  >\n    {({ loading, error, data, refetch, networkStatus }) => {\n      if (loading || networkStatus === NetworkStatus.refetch) {\n        return <Loading />;\n      }\n      if (error) {\n        return (\n          <Error\n            onDismiss={refetch}\n            dismissLabel=\"Retry\"\n            message={error.message}\n          />\n        );\n      }\n      return (\n        <div>\n          <p>\n            <Button text=\"Refresh\" onClick={() => refetch()} />\n          </p>\n          <RatesTable payload={data} />\n        </div>\n      );\n    }}\n  </Query>\n);\n\nexport default Rates;\n","import gql from \"graphql-tag\";\nimport React from \"react\";\nimport { Query } from \"react-apollo\";\nimport { simulateFail } from \"../util\";\nimport Button from \"./Button\";\nimport Rates from \"./Rates\";\n\nconst GET_ACTIVE = gql`\n  {\n    active @client\n  }\n`;\n\nconst App = () => (\n  <div>\n    <h1>Currency Exchange Rates</h1>\n    <main>\n      <p>\n        <label>\n          <input\n            type=\"checkbox\"\n            onChange={simulateFail}\n            defaultChecked={false}\n          />\n          Simulate network failure\n        </label>\n      </p>\n      <Query query={GET_ACTIVE}>\n        {({ data, client }) => {\n          if (data.active) {\n            return <Rates />;\n          }\n          return (\n            <p>\n              <Button\n                text=\"Load\"\n                onClick={() => client.writeData({ data: { active: true } })}\n              />\n            </p>\n          );\n        }}\n      </Query>\n    </main>\n  </div>\n);\n\nexport default App;\n","import React from \"react\";\nimport { ApolloProvider } from \"react-apollo\";\nimport client from \"../client\";\nimport App from \"./App\";\n\nconst ClientApp = () => (\n  <ApolloProvider client={client}>\n    <App />\n  </ApolloProvider>\n);\n\nexport default ClientApp;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport ClientApp from \"./components/ClientApp\";\nimport \"./index.css\";\n\nReactDOM.render(<ClientApp />, document.querySelector(\"#root\"));\n"],"sourceRoot":""}